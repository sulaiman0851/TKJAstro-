---
import Layout from "@layouts/Layout.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";

import { onMount } from "astro/client";

onMount(() => {
  const chatHistory = document.getElementById("chat-history");
  const chatInput = document.getElementById("chat-input-text");
  const chatSubmit = document.getElementById("chat-submit");

  chatSubmit.addEventListener("click", () => {
    const message = chatInput.value;
    if (message.trim() !== "") {
      sendMessage(message, "user");
      // Ganti ini dengan logika AI kamu
      setTimeout(() => {
        sendMessage("Ini contoh balasan AI", "ai");
      }, 1000);
      chatInput.value = "";
    }
  });

  function sendMessage(message, sender) {
    const messageElement = document.createElement("div");
    messageElement.classList.add("chat-message", `${sender}-message`);
    messageElement.textContent = message;
    chatHistory.appendChild(messageElement);
    chatHistory.scrollTop = chatHistory.scrollHeight;
  }
});
---

<Layout>
  <Header />
  <main>
    <slot />
    <h1>Gemini AI</h1>
    <div class="chat-container">
      <div class="chat-history" id="chat-history"></div>

      <div class="chat-input">
        <input type="text" id="chat-input-text" placeholder="Ketik pesan..." />
        <button id="chat-submit">Kirim</button>
      </div>
    </div>
  </main>
  <Footer />
</Layout>

<style>
  main {
    margin: 0;
    font-family: sans-serif;
  }

  .chat-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
  }

  .chat-history {
    flex-grow: 1;
    padding: 20px;
    overflow-y: auto;
  }

  .chat-message {
    margin-bottom: 10px;
    padding: 10px;
    border-radius: 5px;
  }

  .user-message {
    background-color: #eee;
    align-self: flex-end;
  }

  .ai-message {
    background-color: #ccf;
  }

  .chat-input {
    display: flex;
    padding: 10px;
  }

  #chat-input-text {
    flex-grow: 1;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
  }

  #chat-submit {
    padding: 10px 20px;
    margin-left: 10px;
    background-color: #4caf50;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
</style>
